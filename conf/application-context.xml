<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:task="http://www.springframework.org/schema/task"
	xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-4.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd
    	http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
    	http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-4.0.xsd">
	
	<context:component-scan base-package="controllers, core" /> 
	
	<context:annotation-config />
	
	<alias name="${cache.type}" alias="CacheImpl"/>
	
	<bean id="propertyConfigurer"
		class="core.utils.EncryptationAwarePropertyPlaceholderConfigurer">
		<property name="ignoreUnresolvablePlaceholders" value="true" />
		<property name="locations">
			<list>				
				<value>classpath:rms.properties</value>
				<value>file:${CONFIG_DIR}/rms_ext.properties</value>
				<value>file:${CONFIG_DIR}/rms_env.properties</value>	
			</list>
		</property>
	</bean>
	<bean id="velocityEngine" class="org.apache.velocity.app.VelocityEngine"/>
	<bean id="commonUtil" class="core.utils.CommonUtil" />
	<bean id="apnsPushNotificationService" class="core.services.ApnsPushNotificationServiceImpl" />	
	<bean id="gcmPushNotificationService" class="core.services.GcmPushNotificationServiceImpl" />	
	<bean id="webBrowserPushNotificationService" class="core.services.WebBrowserPushNotificationServiceImpl" />	
	<bean id="eventService" class="core.services.EventServiceImpl" />	
	<bean id="notificationService" class="core.services.NotificationServiceImpl" />	
	<bean id="cacheService" class="core.services.CacheServiceImpl" />	
	<bean id="chatMessageService" class="core.services.ChatMessageServiceImpl" />	
	<bean id="groupChatMessageService" class="core.services.GroupChatMessageServiceImpl" />
	<bean id="accessCheckUtil" class="core.utils.AccessCheckUtil" />	
	<bean id="infoService" class="core.services.InfoServiceImpl" />	
	<bean id="websocketExceptionHandler" class="controllers.exceptionMapper.WebsocketExceptionHandler" />	
	<bean id="iqMessageService" class="core.services.IqMessageServiceImpl" />	
	<bean id="userConnectionService" class="core.services.UserConnectionServiceImpl" />
	<bean id="videoSignallingService" class="core.services.VideoSignallingServiceImpl" />
	<bean id="authUtil" class="core.utils.AuthUtil" />
	<bean id="chatHistoryService" class="core.services.ChatHistoryServiceImpl" />
	<bean id="validator" class="core.validator.InputDataValidator" />
	<bean id="memoService" class="core.services.MemoServiceImpl" />
	<bean id="userService" class="core.services.UsersServiceImpl" /> 
	<bean id="monitoringService" class="core.services.MonitoringServiceImpl" />
	<bean id="validatorAspect" class="controllers.aspects.ValidatorAspect" />
	<bean id="validateRequestUtil" class="core.utils.ValidateRequestUtil" />
	<bean id="seoUtil" class="core.utils.SeoUtil" />
	<bean id="redisPubSubSubscriber" class="core.redis.RedisPubSubSubscriber" />
	<bean id="redisPublisher" class="core.redis.RedisPublisher" />
	<bean id="videokycService" class="core.services.VideokycServiceImpl" />
	<bean id="eventTrackingService" class="core.services.EventTrackingServiceImpl" />
	<bean id="dataEncryptionService" class="com.workapps.common.core.services.impl.DataEncryptionServiceImpl" />
	<bean id="encryptionLoader" class="core.encryption.EncryptionLoader" />
	<bean id="recordingService" class="core.services.RecordingServiceImpl" />
	<bean id="meetingService" class="core.services.MeetingServiceImpl" />
	<bean id="chimeMeetingService" class="core.services.ChimeMeetingServiceImpl" />
	<bean id="sqsMessageService" class="core.queue.SQSMessageServiceImpl" />
	<bean id="chimeEventTrackingService" class="core.services.chimeevents.ChimeEventTrackingServiceImpl" />
	<!--<task:annotation-driven executor="presenceTaskExecutor"/> -->
	
	<task:executor id="presenceTaskExecutor" pool-size="${presence.task.executor.pool.size}"
		queue-capacity="${presence.task.executor.queue.size}" keep-alive="${presence.task.executor.keep.alive}" />
	<task:executor id="esFlushTaskExecutor" pool-size="${es.flush.task.executor.pool.size}"
				   queue-capacity="${es.flush.task.executor.queue.size}" keep-alive="${es.flush.task.executor.keep.alive}" />
	<task:scheduler id="scheduler" pool-size="5"/>
</beans>